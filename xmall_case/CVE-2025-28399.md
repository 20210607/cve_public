> [Suggested description]
> An issue in Erick xmall v.1.1 and before allows a remote attacker to
> escalate privileges via the updateAddress method of the Address
> Controller class
>
> ------------------------------------------
>
> [Vulnerability Type]
> Incorrect Access Control
>
> ------------------------------------------
>
> [Vendor of Product]
> Exrick
>
> ------------------------------------------
>
> [Affected Product Code Base]
> xmall - latest, Fix not yet released
>
> ------------------------------------------
>
> [Affected Component]
> xmall
>
> ------------------------------------------
>
> [Attack Type]
> Remote
>
> ------------------------------------------
>
> [Impact Escalation of Privileges]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> 1.Attacker logs in to their own account on the xmall and initiates an address update, triggering a POST request to /member/updateAddress.
> 2.Then,the attacker intercepts the request, modifies the userid in the request body to that of another user.
> 3.The attacker forwards the modified request. Due to the lack of identity verification in the updateAddress method, the target user's address is updated, achieving horizontal privilege escalation.
>
> ------------------------------------------
>
> [Reference]
> https://github.com/Exrick/xmall
>
> ------------------------------------------
>
> [Has vendor confirmed or acknowledged the vulnerability?]
> true
>
> ------------------------------------------
>
> [Discoverer]
> Haoran Zhao, Jinguo Yang, Lei Zhang. Secsys Lab, Fudan University
>

# Vulnerability PoC

## xmall Set up
Use the online demo provided by the xmall GitHub repository: http://xmall.exrick.cn/

## PoC
### Step 1: Log in and Initiate Address Update
Navigate to the mall page and register two accounts, named "test" and "target". Initially, you'll notice that neither account has any shipping addresses. Proceed to add addresses for both accounts. During this process, you can view the complete HTTP requests in Burp Suite. The userid for the "test" account is 62.

<img width="875" alt="截屏2025-04-07 11 05 58" src="https://github.com/user-attachments/assets/a4fe6092-0845-4845-8a1f-591256583ea2" />


The userid for the "target" account is 4791.

<img width="872" alt="截屏2025-04-07 11 06 54" src="https://github.com/user-attachments/assets/7756f601-2236-4245-8dd0-b46421a9e28b" />


Successfully initialize the addresses for both accounts.

### Step 2: Intercept the Request in Burp Suite and Modify the userid Parameter
Assume the "test" account acts as the attacker. Log in to the "test" account and initiate the address - editing process. Modify the address information as shown below.

<img width="863" alt="截屏2025-04-07 11 07 20" src="https://github.com/user-attachments/assets/56ed92de-0b35-42b8-acf2-948edaa7814a" />

Click the "Save" button. At this point, use Burp Suite to intercept the HTTP request. Once the request is captured, locate the userid parameter in the request body and change it to 4791.

<img width="894" alt="截屏2025-04-07 11 07 41" src="https://github.com/user-attachments/assets/7217a1fe-bdce-4ed4-a763-6e88c401c4ca" />


### Step 4: Forward the Modified Request
In Burp Suite, click the "Forward" button to send the modified request to the server. After that, log in to the "target" account. You will find that the address from the "test" account has been successfully added to the "target" account.

<img width="881" alt="截屏2025-04-07 11 07 56" src="https://github.com/user-attachments/assets/b2c5bcb6-bcd9-4139-bcac-06e6a197a66f" />
