> [Suggested description]
> An issue in RUoYi v.4.8.0 allows a remote attacker to escalate
> privileges via the edit method of the /edit/{dictId} endpoint does not
> properly validate whether the requesting user has permission to modify
> the specified dictId
>
> ------------------------------------------
>
> [Vulnerability Type]
> Incorrect Access Control
>
> ------------------------------------------
>
> [Vendor of Product]
> yangzongzhuan
>
> ------------------------------------------
>
> [Affected Product Code Base]
> RuoYi - v4.8.1(latest)  Fix not yet released
>
> ------------------------------------------
>
> [Affected Component]
> com.ruoyi.web.controller.system.SysDictTypeController.edit
>
> ------------------------------------------
>
> [Attack Type]
> Remote
>
> ------------------------------------------
>
> [Impact Escalation of Privileges]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> 1. Suppose an attacker has access to the /edit/{dictId} endpoint in the RuoYi system.
>  2. The attacker can modify the dictId parameter in the request and send a request to edit dictionary data that belongs to other users or system-critical dictionaries.
>  3. Since the application does not properly enforce authorization checks, the attacker can modify dictionary entries they do not own, leading to a horizontal privilege escalation vulnerability."
>
> ------------------------------------------
>
> [Reference]
> https://github.com/yangzongzhuan/RuoYi
>
> ------------------------------------------
>
> [Has vendor confirmed or acknowledged the vulnerability?]
> true
>
> ------------------------------------------
>
> [Discoverer]
> Haoran Zhao, Jinguo Yang, Lei Zhang. Secsys Lab, Fudan University

Use CVE-2025-28407.

# Vulnerability PoC
Vertical Privilege Escalation Vulnerability:
User information is stored in the dictionary. The fact that a regular user can directly modify dictionary entries indicates a vertical privilege escalation vulnerability.

Horizontal Privilege Escalation Vulnerability:
In src/main/java/com/ruoyi/web/controller/system/SysDictTypeController.java, at lines 98 and 99, within the edit method for /edit/{dictId}, simply modifying the dictId allows a user to edit other dictionary entries. The process is as follows:
	1.	Edit the “User Gender” dictionary entry, and change the dictionary name, type, and remark to test:

![alt text](image/image-14.png)

	2.	Click “Edit”, intercept the request using Burp, change dictId to 2, then click “Forward”:

![alt text](image/image-15.png)

	3.	It can be observed that the second dictionary under the “User Gender” category has been completely modified:

![alt text](image/image-16.png)